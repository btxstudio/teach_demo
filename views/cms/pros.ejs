<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>旅游预订平台CMS-产品列表页</title>

    <%- include("common/header_js") %>
</head>

<body>

    <!-- 顶部工具栏 -->
    <%- include("common/header") %>

    <div class="d-flex align-items-stretch">
        
        <!-- 左侧边栏导航 -->
        <%- include("common/nav_aside") %>
        
        <!-- 产品列表 -->
        <div class="page-content" id="editeArea">
            <div class="page-header">
                <div class="container-fluid">
                    <h2 class="h5 row no-margin-bottom">
                        <div class="col-6">旅游产品管理界面</div>
                        <div class="col-6 text-right"><a data-toggle="modal" data-target="#myModal" href="#"><i class="icon-new-file"></i> 新增产品</a></div>
                    </h2>
                </div>
            </div>
            <section class="no-padding-bottom">

                <!-- 编辑弹窗 -->
                <div id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" class="modal fade text-left">
                    <div role="document" class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header"><strong id="exampleModalLabel" class="modal-title">产品详情编辑面板</strong>
                                <button type="button" data-dismiss="modal" aria-label="Close" class="close"><span aria-hidden="true">×</span></button>
                            </div>
                            <div class="modal-body">
                                <form>
                                    <div class="text-center">
                                        <img data-cover class="w-25 rounded" onerror="this.src = '/img/default.jpg'" /><br><br>
                                        <p class="small">点击图片以上传封面</p>
                                        <input data-upload type="file" name="cover" style="display: none;">
                                    </div>
                                    <div class="form-group">
                                        <label>产品地点</label>
                                        <input type="text" name="addr" class="form-control">
                                    </div>
                                    <div class="form-group">
                                        <label>产品标题</label>
                                        <input type="text" name="title" class="form-control">
                                    </div>
                                    <div class="form-group">
                                        <label>产品价格</label>
                                        <input type="number" name="price" class="form-control">
                                    </div>
                                    <div class="form-group">
                                        <label>产品时间</label>
                                        <input type="text" name="duration" class="form-control">
                                    </div>
                                    <div class="form-group">
                                        <label>产品描述</label>
                                        <textarea name="description" class="form-control"></textarea>
                                    </div>
                                </form>

                            </div>
                            <div class="modal-footer">
                                <button data-del-btn type="button" data-dismiss="modal" class="btn btn-secondary">删除产品</button>
                                <button data-mod-btn type="button" class="btn btn-primary">保存修改</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="container-fluid">
                    <div class="row">
                        
                        <% for(let i=0; i<3; i++){ %>
                        <div class="col-lg-4">
                            <div class="user-block block text-center" data-toggle="modal" data-target="#myModal" 
                                data-id="<%= data[i]._id %>"
                                data-addr="<%= data[i].addr %>" 
                                data-title="<%= data[i].title %>" 
                                data-price="<%= data[i].price %>" 
                                data-duration="<%= data[i].duration %>" 
                                data-description="<%= data[i].description %>" 
                            >
                                <div class="avatar"><img src="/img/<%= data[i]._id %>.jpg" class="img-fluid" onerror="this.src = '/img/default.jpg'"></div>
                                <span class="user-title">
                                    <h3 class="h5"><%= data[i].addr %></h3><span><%= data[i].title %></span>
                                </span>
                                <div class="contributions"><%= data[i].description %></div>
                                <div class="details row">
                                    <div class="col-6">￥ <%= data[i].price %></strong></div>
                                    <div class="col-6"><i class="fa fa-gg"></i><strong><%= data[i].duration %></strong></div>
                                </div>
                            </div>
                        </div>
                        <% } %>

                    </div>

                    <% for(let i=3; i<data.length; i++){ %>
                    <div class="public-user-block block" data-toggle="modal" data-target="#myModal" 
                        data-id="<%= data[i]._id %>"
                        data-addr="<%= data[i].addr %>" 
                        data-title="<%= data[i].title %>" 
                        data-price="<%= data[i].price %>" 
                        data-duration="<%= data[i].duration %>" 
                        data-description="<%= data[i].description %>" 
                    >
                        <div class="row d-flex align-items-center">
                            <div class="col-lg-4 d-flex align-items-center">
                                <div class="avatar"> 
                                    <img src="/img/<%= data[i]._id %>.jpg" class="img-fluid" onerror="this.src = '/img/default.jpg'">
                                </div>
                                <span class="name">
                                    <strong class="d-block"><%= data[i].addr %></strong><span class="d-block"><%= data[i].title %></span>
                                </span>
                            </div>
                            <div class="col-lg-4 text-center">
                                <div class="contributions"><%= data[i].description %></div>
                            </div>
                            <div class="col-lg-4">
                                <div class="details d-flex">
                                    <div class="item"><strong>￥ <%= data[i].price %></strong></div>
                                    <div class="item"><i class="fa fa-gg"></i><strong><%= data[i].duration %></strong></div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <% } %>

                </div>
            </section>
        </div>

    </div>

    <%- include("common/footer_js") %>

    <script src="/js/editPannel.js"></script>
    <script>
        new window.external.editePannel("#editeArea", {
            del_api: "/travel/pros/api/del",
            mod_api: "/travel/pros/api/mod",
            add_api: "/travel/pros/api/add",
            img_path: "/img"
        });
    </script>
</body>

</html>